\documentclass[xcolor={usenames,dvipsnames,svgnames}]{beamer}
\usepackage[utf8]{inputenc}
\DeclareUnicodeCharacter{2212}{-}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{hyperref}
\usepackage{mathtools}

%\AtBeginSection[] { \begin{frame} \frametitle{Table of Contents}
%\tableofcontents[currentsection] \end{frame} }
\usetheme{Berlin}
\usecolortheme{beaver}

% Custom math commands, other shortcuts
\newcommand{\tenexp}[1]{\times10^{#1}}
\newcommand{\dee}{\;\mathsf{d}}
\let\oldvec\vec
\renewcommand{\vec}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\evec}[1]{\ensuremath{\vec{e}_{#1}}} % standard basis vector
\newcommand{\norm}[2]{\ensuremath{\|#1\|_{#2}}}
\newcommand{\bignorm}[2]{\ensuremath{\left\|#1\right\|_{#2}}}
\newcommand{\infnorm}[1]{\ensuremath{\|#1\|_\infty}}
\newcommand{\reals}{\ensuremath{\mathbb{R}}}
\DeclareMathOperator{\Prob}{P}
% Physics Domain-Specific
\newcommand{\kB}{\ensuremath{k_\mathrm{B}}}
% General Shortcuts
\newcommand{\figref}[1]{Figure~\ref{#1}}
\newcommand{\secref}[1]{Section~\ref{#1}}

\newtheorem{assumption}{Assumption}

\begin{document}
\title[Genetic Networks]{Stochastic Simulation of Genetic Regulatory Networks}
\author[Max Veit]{Max Veit\\Advisor: Jorge Viñals}
\date[2014-05-07{7 May 2014}
\institute[U of MN]{University of Minnesota}
\subject{Physics}

\frame{\titlepage}

\section{Introduction} % (fold)
\label{sec:introduction}
\begin{frame}
    \frametitle{Genetic Regulation}
    \begin{center}
    \end{center}
    \begin{columns}[c]
        \begin{column}[c]{0.7\textwidth}
            %\vspace{-0.5cm}
            \begin{itemize}
                \item Genetic switches
                \item Complex networks
                \item New area of biophysics
            \end{itemize}
            \includegraphics[width=\textwidth]{ecoli-switch.png} \footnotesize{\cite{decision-making}}
        \end{column}
        \begin{column}[c]{0.3\textwidth}
            \includegraphics[width=\textwidth]{h_circadianPathway.png} \footnotesize{\cite{biocarta}}
        \end{column}
    \end{columns}
    \vspace{1.5cm}
\end{frame}

\begin{frame}
    \frametitle{Synthetic Biology}

    (Picture for synthetic biology)

    \begin{itemize}
        \item Synthetic cells instead of nanobots
        \item Drug delivery
        \item Biomolecule production
        \item Artificial viruses
        \item Replacement tissue
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Cellular Scale}

    \begin{center}
        \includegraphics[height=0.6\textheight]{cell-stochasticity.png} \footnotesize{\cite{decision-making}}
    \end{center}

    (Mention stochasticity, $1/\sqrt{N}$ and how it applies to test tubes, cells)
\end{frame}

\begin{frame}
    \frametitle{Representation}
    \begin{itemize}
        \item Reaction Equations
        \item Chemical System
    \end{itemize}
    \begin{columns}[c]
        \begin{column}{0.5\textwidth}
            \begin{align*}
                \varnothing \xrightarrow{A} X \\
                X \xrightarrow {B} \varnothing
            \end{align*}
        \end{column}
        \begin{column}{0.5\textwidth}
            (Picture of chemical system)
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Biological ``Reactions''}
    \begin{itemize}
        \item Sequence of many small reactions
        \item Need to account for time delay
        %\item Abstract sequence into one reaction with a delay
    \end{itemize}
    %$\varnothing\quad\xrightarrow[(\tau)]{k}$
    \begin{center}
        \input{figures/dna-and-rna.pdf_tex}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Effects of Delay}
    \begin{itemize}
        \item Even differential equations become much harder (example)
        \item (Mention mathematical difficulty, non-Markovian, breaks existing theories)
    \end{itemize}
\end{frame}

% section introduction (end)

\section{Stochastic Chemical Kinetics} % (fold)
\label{sec:modeling}

\begin{frame}
    \frametitle{First Approach}
    \begin{itemize}
        \item Continuum limit
        \item Turn chemical equations into differential equations
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Stochastic Effects}
    \begin{columns}[c]
        \begin{column}{0.5\textwidth}
            \begin{center}
                \resizebox{\textwidth}{!}{
                    \input{figures/cont-stochastic.pgf}
                }
            \end{center}
        \end{column}
        \begin{column}{0.5\textwidth}
            \begin{itemize}
                \item Significant at cellular scale
                \item Concentrations fluctuate; no determinism
                \item Concentrations are discrete (``populations''): Most models require continuous!
            \end{itemize}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Finding the Probability Distribution}

    \begin{itemize}
        \item Assumptions on chemical system
        \item Defining propensity \cite{gillespie-07}: $ P_j(\vec{x}, [t, t+\dee t]) = a_j(\vec{x})\dee t $
        \item Reaction physics?
        \item Result: Chemical master equation
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Gillespie SSA}
    Monte Carlo method

    (Picture illustrating how SSA works)
\end{frame}

\begin{frame}
    \frametitle{Getting the Probability Distribution}
    \begin{itemize}
        \item Trajectory is only \emph{sample} of system
        \item Make histogram
    \end{itemize}
\end{frame}

% section modeling (end)

\section{Weighted Ensemble} % (fold)
\label{sec:resampling}

\begin{frame}
    \frametitle{More Complex Systems}
    \begin{center}
        \input{figures/bimodal.pdf_tex}
    \end{center}

    \begin{itemize}
        \item Many stable states
        \item Infrequent transitions
        \item Inefficient sampling
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Weighted-Ensemble Resampling}
    Each trajectory gets a weight $w_j$.\\
    \begin{center}
        \begin{overprint}
            \onslide<1|handout:0>
            \input{figures/wessa-seq00.pdf_tex}
            \onslide<2|handout:0>
            \input{figures/wessa-seq01.pdf_tex}
            \onslide<3|handout:0>
            \input{figures/wessa-seq02.pdf_tex}
            \onslide<4>
            \input{figures/wessa-seq03.pdf_tex}
            \onslide<5>
            \input{figures/wessa-seq04.pdf_tex}
        \end{overprint}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Conceptual Issues}

    \begin{center}
        \input{figures/wessa-timestep.pdf_tex}
    \end{center}

    \begin{itemize}
        \item SSA: Non-uniform timesteps
        \item How I addressed the issue
        \pause
        \item What about delayed reactions?
    \end{itemize}

\end{frame}

% section resampling (end)

\section{Results}

\begin{frame}
    \frametitle{Production-Degradation Results}
    \begin{center}
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/pdwe-a400-cmp.pgf}
        }
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/pdwe-a400-devs.pgf}
        }
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Production-Degradation, Continued}
    With a smaller system volume:

    \begin{center}
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/pdwe-a100-cmp.pgf}
        }
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/pdwe-a100-devs.pgf}
        }
    \end{center}

    \pause
    Try a non-Markovian system.
\end{frame}

\begin{frame}
    \frametitle{Delayed-Degradation System}
    \begin{columns}[c]
        \begin{column}{0.5\textwidth}
            \begin{align*}
                \varnothing \xrightarrow{A} X \\
                X \xrightarrow{B} \varnothing \\
                X \xRightarrow[(\tau)]{C} \varnothing
            \end{align*}
        \end{column}
        \begin{column}{0.5\textwidth}
            \begin{center}
                \resizebox{\textwidth}{!}{
                    \input{figures/delayed-degradation.pgf}
                }
            \end{center}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}
    \frametitle{Delayed-Degradation Results}
    \begin{center}
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/ddwe-t0.1-a800-cmp.pgf}
        }
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/ddwe-t0.1-a800-devs.pgf}
        }
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Delayed-Degradation, Continued}
    Now with a larger delay $\tau$:

    \begin{center}
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/ddwe-t1-a800-cmp.pgf}
        }
        \resizebox{0.48\textwidth}{!}{
            \input{../results/presentation/ddwe-t1-a800-devs.pgf}
        }
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Master Equation For Delayed Degradation}

    (Give explicit form, motivate delayed-joint distribution)
\end{frame}

\begin{frame}
    \frametitle{Delayed Joint Distribution}
    \begin{center}
        $\Prob \left(n(t) = p \text{ AND } n(t - \tau) = q \right)$

        \includegraphics[height=0.6\textheight]{../results/presentation/ddjd-a100-c3.png}
    \end{center}
\end{frame}

\begin{frame}
    \frametitle{Qualitative Behavior}

    (Show with corresponding time-evolution plots)
    \includegraphics[width=0.3\textwidth]{../results/presentation/ddjd-a100-c1.png}
    \includegraphics[width=0.3\textwidth]{../results/presentation/ddjd-a100-c3,3.png}
    \includegraphics[width=0.3\textwidth]{../results/presentation/ddjd-a100-c4,7.png}
\end{frame}

\begin{frame}
    \frametitle{Conditional Average}

    (Motivate cond'l average, introduce mean-field approximation)
\end{frame}

\begin{frame}
    \frametitle{Conditional Average, Calculation}

    Average the $q$-values at every value of $p$

    %\resizebox{0.5\textwidth}{!}{
        %\input{../results/presentation/ddjd-ca-a400-c5.pgf}
    %}

    \begin{center}
        \includegraphics[width=0.5\textwidth]{../results/presentation/ddjd-ca-a100-c2-t1.png}
    \end{center}

    Possible assumption: Independent of $p$
\end{frame}

\begin{frame}
    \frametitle{Stable Mode}
    Independent of $p$?

    \begin{center}
        \includegraphics[width=0.5\textwidth]{../results/presentation/ddjd-ca-a100-c2-t1-flat.png}
    \end{center}

    ...sort of.

\end{frame}

\begin{frame}
    \frametitle{Near the Bifurcation}

    \begin{overprint}
        \onslide<1>
        \begin{center}
        \includegraphics[width=0.5\textwidth]{../results/presentation/ddjd-ca-a100-c5,8-t1.png}
        \end{center}
        \onslide<2>
        \begin{center}
        \includegraphics[width=0.5\textwidth]{../results/presentation/ddjd-ca-a400-c5-t1.png}
        \end{center}
    \end{overprint}

    Definitely not independent. Also note saturation.
\end{frame}

\begin{frame}
    \frametitle{Oscillatory Mode}

    \begin{center}
        \includegraphics[width=0.5\textwidth]{../results/presentation/ddjd-ca-a100-c5-t20.png}
    \end{center}

    Saturated value agrees with average of lower peak.
\end{frame}

\begin{frame}
    \frametitle{Summary}
    \begin{itemize}
        \item Effects of discreteness, stochasticity
        \item Stochastic simulation with weighted ensemble
        \item Unbiased sample, even with delays
        \item Current work: Simulate more realistic systems
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Acknowledgments}
    Jorge Viñals (Advisor)\\[2ex]

    Vincent Noireaux (Reader)\\
    Yiannis Kaznessis (Reader)\\[2ex]

    Dan Dahlberg (Feedback \& Talks)
\end{frame}

\begin{frame}[plain]

\hfill
    \begin{beamercolorbox}[rounded=true, center, shadow=true,wd=6cm]{title}
        \huge Questions?
    \end{beamercolorbox}
\hfill\hfill

\end{frame}

\appendix

\begin{frame}
    \frametitle{References}
    \begin{thebibliography}{9}
        \bibitem{decision-making} Phys. Today 67, 2, 31 (2014); \url{http://dx.doi.org.ezp1.lib.umn.edu/10.1063/PT.3.2276}
        \bibitem{biocarta} ``Biocarta - Charting Pathways of Life.'' \url{http://www.biocarta.com/genes/index.asp}.
        \bibitem{gillespie-07} D. Gillespie, Annu. Rev. Phys. Chem. \textbf{58}, 35-55 (2007).
    \end{thebibliography}
\end{frame}

\end{document}
